{"version":3,"sources":["MoleculeStructure.js","App.js","index.js"],"names":["MoleculeStructure","props","RDKit","window","MOL_DETAILS","JSON","stringify","width","DEFAULT_SIZE","height","bondLineWidth","addStereoAnnotation","structure","state","svg","undefined","mol","get_mol","rdKitLoaded","rdKitError","this","draw","initRDKitModule","then","setState","catch","prevProps","prevState","rdkitStateChanged","structureChanged","oldMol","isValidMol","svgMode","get_svg_with_highlights","canvas","document","getElementById","id","draw_to_canvas_with_highlights","title","className","style","dangerouslySetInnerHTML","__html","substring","is_valid","Component","App","ReactDOM","render","StrictMode"],"mappings":"wRAIMA,E,kDAMJ,WAAYC,GAAQ,IAAD,uBACjB,cAAMA,IAEDC,MAAQC,OAAOD,MAEpB,EAAKE,YAAcC,KAAKC,UAAU,CAChCC,MAAO,EAAKN,MAAMM,OAASP,EAAkBQ,aAAaD,MAC1DE,OAAQ,EAAKR,MAAMQ,QAAUT,EAAkBQ,aAAaC,OAC5DC,cAAe,EACfC,qBAAqB,IAGvB,IAAMC,EAC4B,kBAAzB,EAAKX,MAAMW,UAAyB,EAAKX,MAAMW,UAAY,GAbnD,OAcjB,EAAKC,MAAQ,CACXC,SAAKC,EACLC,IAAK,EAAKd,OAAS,EAAKA,MAAMe,QAAQL,GACtCM,cAAe,EAAKhB,MACpBiB,YAAY,GAlBG,E,qDAsBnB,WAAqB,IAAD,OAClBC,KAAKC,OAEAD,KAAKP,MAAMK,aACdf,OACGmB,kBACAC,MAAK,SAACrB,GACLC,OAAOD,MAAQA,EACf,EAAKA,MAAQC,OAAOD,MACpB,EAAKsB,SAAS,CAAEN,aAAa,EAAMC,YAAY,OAEhDM,OAAM,WACL,EAAKD,SAAS,CAAEN,aAAa,EAAOC,YAAY,S,gCAKxD,SAAmBO,EAAWC,GAAY,IAAD,OACjCC,EACJD,EAAUT,cAAgBE,KAAKP,MAAMK,YACjCW,EAAmBH,EAAUd,YAAcQ,KAAKnB,MAAMW,UAE5D,GAAIgB,GAAqBC,EAAkB,CACzC,IAAIC,EAASV,KAAKP,MAAMG,KAAO,GAC/BI,KAAKI,SAAS,CAAER,IAAKI,KAAKlB,MAAMe,QAAQG,KAAKnB,MAAMW,aAAc,kBAC/D,EAAKS,UAMe,kBAAXS,IACTA,EAAS,S,kBAKf,WACE,IAAMC,EAAaX,KAAKW,aACxB,GAAIA,GAAcX,KAAKnB,MAAM+B,QAAS,CACpC,IAAMlB,EAAMM,KAAKP,MAAMG,IAAIiB,wBAAwBb,KAAKhB,aACxDgB,KAAKI,SAAS,CAAEV,aACX,GAAIiB,EAAY,CACrB,IAAMG,EAASC,SAASC,eAAehB,KAAKnB,MAAMoC,IAClDjB,KAAKP,MAAMG,IAAIsB,+BAA+BJ,EAAQd,KAAKhB,gB,oBAI/D,WACE,GAAIgB,KAAKP,MAAMM,WACb,MAAO,0BAET,IAAKC,KAAKP,MAAMK,YACd,MAAO,sBA8BT,OA1BKE,KAAKW,aAMCX,KAAKnB,MAAM+B,QAElB,qBACEO,MAAOnB,KAAKnB,MAAMW,UAClB4B,UAAW,2BAA6BpB,KAAKnB,MAAMuC,WAAa,IAChEC,MAAO,CAAElC,MAAOa,KAAKnB,MAAMM,MAAOE,OAAQW,KAAKnB,MAAMQ,QACrDiC,wBAAyB,CAAEC,OAAQvB,KAAKP,MAAMC,OAKhD,wBACEyB,MAAOnB,KAAKnB,MAAMW,UAClByB,GAAIjB,KAAKnB,MAAMoC,GACf9B,MAAOa,KAAKnB,MAAMM,MAClBE,OAAQW,KAAKnB,MAAMQ,SAnBrB,uBAAM8B,MAAOnB,KAAKnB,MAAMW,UAAxB,UACGQ,KAAKnB,MAAMW,UAAUgC,UAAU,EAAG,GADrC,Y,wBA2BN,WACE,QAASxB,KAAKP,MAAMG,KAAOI,KAAKP,MAAMG,IAAI6B,e,GAnHdC,aAA1B9C,EACGQ,aAAe,CACpBD,MAAO,IACPE,OAAQ,KA6HGT,QCnHA+C,MAdf,WAEE,OACE,qBAAKP,UAAU,MAAf,SACE,cAAC,EAAD,CACEjC,MAAO,IACPE,OAAQ,IACRG,UANW,8BAOXyB,GAAG,2BCNXW,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFf,SAASC,eAAe,W","file":"static/js/main.aa356000.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport \"./MoleculeStructure.css\";\nimport PropTypes from \"prop-types\";\n\nclass MoleculeStructure extends Component {\n  static DEFAULT_SIZE = {\n    width: 250,\n    height: 200,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.RDKit = window.RDKit;\n\n    this.MOL_DETAILS = JSON.stringify({\n      width: this.props.width || MoleculeStructure.DEFAULT_SIZE.width,\n      height: this.props.height || MoleculeStructure.DEFAULT_SIZE.height,\n      bondLineWidth: 1,\n      addStereoAnnotation: true,\n    });\n\n    const structure =\n      typeof this.props.structure === \"string\" ? this.props.structure : \"\";\n    this.state = {\n      svg: undefined,\n      mol: this.RDKit && this.RDKit.get_mol(structure),\n      rdKitLoaded: !!this.RDKit,\n      rdKitError: false,\n    };\n  }\n\n  componentDidMount() {\n    this.draw();\n\n    if (!this.state.rdKitLoaded) {\n      window\n        .initRDKitModule()\n        .then((RDKit) => {\n          window.RDKit = RDKit;\n          this.RDKit = window.RDKit;\n          this.setState({ rdKitLoaded: true, rdKitError: false });\n        })\n        .catch(() => {\n          this.setState({ rdKitLoaded: false, rdKitError: true });\n        });\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const rdkitStateChanged =\n      prevState.rdKitLoaded !== this.state.rdKitLoaded;\n    const structureChanged = prevProps.structure !== this.props.structure;\n\n    if (rdkitStateChanged || structureChanged) {\n      let oldMol = this.state.mol || {};\n      this.setState({ mol: this.RDKit.get_mol(this.props.structure) }, () =>\n        this.draw()\n      );\n      /**\n       * attempt at forcing old mol objects\n       * to be garbage collected\n       */\n      if (typeof oldMol === \"object\") {\n        oldMol = null;\n      }\n    }\n  }\n\n  draw() {\n    const isValidMol = this.isValidMol();\n    if (isValidMol && this.props.svgMode) {\n      const svg = this.state.mol.get_svg_with_highlights(this.MOL_DETAILS);\n      this.setState({ svg });\n    } else if (isValidMol) {\n      const canvas = document.getElementById(this.props.id);\n      this.state.mol.draw_to_canvas_with_highlights(canvas, this.MOL_DETAILS);\n    }\n  }\n\n  render() {\n    if (this.state.rdKitError) {\n      return \"Error loading renderer.\";\n    }\n    if (!this.state.rdKitLoaded) {\n      return \"Loading renderer...\";\n    }\n\n    let compound = null;\n    if (!this.isValidMol()) {\n      compound = (\n        <span title={this.props.structure}>\n          {this.props.structure.substring(0, 6)} ...\n        </span>\n      );\n    } else if (this.props.svgMode) {\n      compound = (\n        <div\n          title={this.props.structure}\n          className={\"molecule-structure-svg \" + (this.props.className || \"\")}\n          style={{ width: this.props.width, height: this.props.height }}\n          dangerouslySetInnerHTML={{ __html: this.state.svg }}\n        ></div>\n      );\n    } else {\n      compound = (\n        <canvas\n          title={this.props.structure}\n          id={this.props.id}\n          width={this.props.width}\n          height={this.props.height}\n        ></canvas>\n      );\n    }\n\n    return compound;\n  }\n\n  isValidMol() {\n    return !!this.state.mol && this.state.mol.is_valid();\n  }\n}\n\nMoleculeStructure.propTypes = {\n  id: PropTypes.string.isRequired,\n  structure: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  svgMode: PropTypes.bool,\n  width: PropTypes.number,\n  height: PropTypes.number,\n};\n\nexport default MoleculeStructure;\n","import \"./App.css\";\nimport MoleculeStructure from \"./MoleculeStructure\";\n\nfunction App() {\n  const caffeine = \"CN1C=NC2=C1C(=O)N(C(=O)N2C)\";\n  return (\n    <div className=\"App\">\n      <MoleculeStructure\n        width={350}\n        height={300}\n        structure={caffeine}\n        id=\"structure-example-1\"\n      />\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}